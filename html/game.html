<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Game Download</title>
  <link rel="stylesheet" href="/game-hub/css/downloads.css">
</head>

<body>
  <div id="header"></div>

  <!-- Download Section -->
  <section class="downloads container" id="game-content">
    <p>Loading game details...</p>
  </section>

  <div id="footer"></div>

  <script>
    // Load header & footer dynamically
    fetch("/game-hub/header.html").then(r => r.text()).then(html => document.getElementById("header").innerHTML = html);
    fetch("/game-hub/footer.html").then(r => r.text()).then(html => document.getElementById("footer").innerHTML = html);

    // Get the game ID from ?id= parameter
    const params = new URLSearchParams(window.location.search);
    const gameId = params.get("id");

    fetch("games.json")
      .then(res => res.json())
      .then(games => {
        const game = games.find(g => g.id === gameId);
        const section = document.getElementById("game-content");

        if (!game) {
          section.innerHTML = "<h2>Game not found.</h2>";
          return;
        }

        document.title = `Download - ${game.title}`;
        document.getElementById("page-title").textContent = `Download - ${game.title}`;

        // Generate download links
        const links = game.download_links.map(l => `<li><a href="${l.url}" target="_blank">${l.name}</a></li>`).join("");

        // Generate system requirements
        const sysreq = game.system_requirements.map(r => `<li>${r}</li>`).join("");

        section.innerHTML = `
          <h2>Download ${game.title}</h2>
          <div class="game-card">
            <img src="${game.image}" alt="${game.title}">
            <div class="game-info">
              <h3>${game.title}</h3>
              <p>${game.description}</p>
              <h4>Download Link:</h4>
              <ul class="download-list">${links}</ul>
            </div>
          </div>

          <div class="sys-requirements">
            <p><strong>System Requirements:</strong></p>
            <ul>${sysreq}</ul>
          </div>

          <div class="install-guide">
            <h2>Installation Guide</h2>
            <ol>
              <li>Download all the parts completely.</li>
              <li>Extract the first part (others will extract automatically).</li>
              <li>Open the folder and run <strong>setup.exe</strong>.</li>
              <li>Follow the instructions to install the game.</li>
            </ol>
            <p><strong>Note:</strong> Use WinRAR/7-Zip to extract files properly.
            Clicking On The Download Link Will Take You To Our Telegram Channel Where All The Game Parts Will
            Be Sent To You Though Our Telegram Bot, Forward All Parts To Your Saved Messages Because They Will Be 
            Deleted automatically After 10 mins.</p>
          </div>
        `;
      })
      .catch(err => {
        console.error(err);
        document.getElementById("game-content").innerHTML = "<p>Error loading game data.</p>";
      });
  </script>
</body>
</html>
